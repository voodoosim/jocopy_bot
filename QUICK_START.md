# JoCopy Bot - 빠른 시작 가이드

> **버전**: v0.3.0 (2025-11-14)
> **상태**: `.소스입력`, `.타겟입력` 구현 완료

---

## 🚀 빠른 시작 (5분)

### 1단계: Main Bot 실행 확인

```bash
# 프로젝트 디렉토리로 이동
cd ~/projects/jocopy_bot

# 봇 실행 중인지 확인
ps aux | grep "python3 bot.py" | grep -v grep

# 실행 안되어 있으면 시작
python3 bot.py > bot.log 2>&1 &

# 로그 확인 (정상 시작 확인)
tail -20 bot.log
```

**기대 출력**:
```
INFO - Bot started successfully
INFO - Listening for commands...
```

### 2단계: 워커 시작

**Telegram에서** `@JoCopy_bot`으로 이동:

```
/유닛목록
→ 등록된 워커 확인

/유닛시작 1
→ "✅ 워커 #1 (백도하) 시작 완료!"
```

### 3단계: 소스/타겟 설정

**워커 계정의 Saved Messages**로 이동:

**방법 A: 새 명령어 사용** (권장)
```
.소스입력
→ c1 또는 g1 입력

.타겟입력
→ c2 또는 g2 입력
→ 권한 체크 자동 완료
```

**방법 B: 기존 명령어 사용**
```
.설정
→ 소스: c1
→ 타겟: g2
→ 권한 체크 자동 완료
```

### 4단계: 미러링 시작

```
.미러
→ "🔄 미러링 시작..."
→ "✅ 초기 복사: N개"
→ "🔄 실시간 동기화 활성"
```

완료! 이제 소스에 새 메시지가 올라오면 자동으로 타겟에 복사됩니다.

---

## 📋 명령어 빠른 참조

### Manager Bot 명령어 (@JoCopy_bot)

| 명령어 | 설명 |
|--------|------|
| `/유닛목록` | 등록된 워커 목록 |
| `/유닛시작 [ID]` | 워커 시작 |
| `/유닛중지 [ID]` | 워커 중지 |
| `/유닛추가` | 새 워커 등록 |

### Worker 명령어 (Saved Messages)

| 명령어 | 설명 | 상태 |
|--------|------|------|
| `.소스입력` | 소스만 설정 | ⭐ 신규 |
| `.타겟입력` | 타겟만 설정 + 권한 체크 | ⭐ 신규 |
| `.설정` | 소스+타겟 한번에 설정 | 기존 |
| `.장전` | 현재 설정 확인 | |
| `.미러` | 실시간 미러링 시작 | |
| `.카피` | 전체 메시지 복사 | |
| `.중지` | 중지 | |

---

## 🎯 사용 시나리오

### 시나리오 1: 첫 설정 (소스+타겟)

```
워커 Saved Messages:
.소스입력 → c1
.타겟입력 → g2
.미러
```

### 시나리오 2: 타겟만 변경

```
이미 소스가 설정되어 있음
.타겟입력 → c3  (새 타겟)
.미러
```

### 시나리오 3: 소스만 변경

```
이미 타겟이 설정되어 있음
.소스입력 → g2  (새 소스)
.미러
```

### 시나리오 4: 여러 타겟에 순차 복사

```
.소스입력 → c1
.타겟입력 → g1 → .카피 (완료 대기)
.타겟입력 → g2 → .카피 (완료 대기)
.타겟입력 → g3 → .카피
```

---

## 🔧 문제 해결 (30초)

### 문제: 워커가 시작 안됨

```bash
# DB 상태 리셋
python3 -c "
import asyncio
import aiosqlite
async def reset():
    async with aiosqlite.connect('./jocopy.db') as db:
        await db.execute('UPDATE workers SET status = \"stopped\", process_id = NULL')
        await db.commit()
asyncio.run(reset())
"

# 워커 재시작
@JoCopy_bot에서: /유닛시작 1
```

### 문제: 명령어가 응답 안함

**원인**: 워커 프로세스가 죽음

**해결**: `@JoCopy_bot`에서 `/유닛시작 1`

### 문제: 권한 오류

```
.타겟입력
→ "❌ 타겟 쓰기 권한 없음!"
```

**해결**:
1. 타겟 채널/그룹으로 이동
2. 워커 계정을 관리자로 추가
3. "메시지 게시" 권한 활성화
4. `.타겟입력` 다시 실행

---

**마지막 업데이트**: 2025-11-14 (v0.3.0)
